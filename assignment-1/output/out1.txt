cc    -c -o utils.o utils.c
gcc -o lc_pthreads lc_pthreads.c utils.o
./lc_pthreads dataset/MNIST_data.csv dataset/MNIST_label.csv 30 16
Iteration 1 loss: 3323.002978
Iteration 2 loss: 1626.377295
Iteration 3 loss: 962.506536
Iteration 4 loss: 795.911564
Iteration 5 loss: 702.862772
Iteration 6 loss: 652.345262
Iteration 7 loss: 620.026778
Iteration 8 loss: 594.173429
Iteration 9 loss: 573.615597
Iteration 10 loss: 556.752140
Iteration 11 loss: 542.333746
Iteration 12 loss: 529.824685
Iteration 13 loss: 518.893178
Iteration 14 loss: 509.224548
Iteration 15 loss: 500.524193
Iteration 16 loss: 492.554520
Iteration 17 loss: 485.125482
Iteration 18 loss: 478.094898
Iteration 19 loss: 471.372296
Iteration 20 loss: 464.912929
Iteration 21 loss: 458.701181
Iteration 22 loss: 452.733237
Iteration 23 loss: 447.005717
Iteration 24 loss: 441.510692
Iteration 25 loss: 436.234736
Iteration 26 loss: 431.160196
Iteration 27 loss: 426.267749
Iteration 28 loss: 421.539358
Iteration 29 loss: 416.960770
Iteration 30 loss: 412.522997

Execution time: 2.9405s

Final weights:
0: 0.000000
1: 0.000000
2: 0.000000
3: 0.000000
4: 0.000000
5: 0.000000
6: 0.000000
7: 0.000000
8: 0.000000
9: 0.000000
10: 0.000000
11: 0.000000
12: 0.000000
13: 0.000000
14: 0.000000
15: 0.000000
16: 0.000000
17: 0.000000
18: 0.000000
19: 0.000000
20: 0.000000
21: 0.000000
22: 0.000000
23: 0.000000
24: 0.000000
25: 0.000000
26: 0.000000
27: 0.000000
28: 0.000000
29: 0.000000
30: 0.000000
31: 0.000000
32: 0.000000
33: 0.000000
34: 0.000000
35: 0.000000
36: 0.000000
37: 0.000000
38: 0.000000
39: 0.000000
40: 0.000000
41: 0.000000
42: 0.403563
43: 0.000000
44: 0.000000
45: 0.000000
46: 0.000000
47: 0.000000
48: 0.000000
49: 0.000000
50: 0.000000
51: 0.000000
52: 0.000000
53: 0.000000
54: 0.000000
55: 0.000000
56: 0.000000
57: 0.000000
58: 0.000000
59: 0.000000
60: 0.000000
61: 0.000000
62: 0.000000
63: 0.000000
64: 0.000000
65: 0.000000
66: 0.000000
67: 12.987359
68: 0.051548
69: 0.393589
70: -0.264375
71: 0.236574
72: 0.152835
73: -13.923561
74: -0.102720
75: 0.000000
76: 0.000000
77: 0.000000
78: 0.000000
79: 0.000000
80: 0.000000
81: 0.000000
82: 0.000000
83: 0.000000
84: 0.000000
85: 0.000000
86: 0.000000
87: 0.000000
88: 0.000000
89: 0.000000
90: 0.000000
91: 0.000000
92: 0.000000
93: -0.147281
94: -0.131344
95: -1.037606
96: 0.683665
97: -0.244655
98: 0.136661
99: 0.000119
100: -0.007326
101: -0.049297
102: 0.404771
103: -0.519793
104: 0.836800
105: -2.676507
106: 1.214651
107: -0.000000
108: 0.000000
109: 0.000000
110: 0.000000
111: 0.000000
112: 0.000000
113: 0.000000
114: 0.000000
115: 0.000000
116: 0.239237
117: 0.000000
118: 0.000000
119: 1.746930
120: -0.350130
121: 0.376704
122: 0.271692
123: 0.040371
124: -0.011677
125: 0.067203
126: -0.019514
127: 0.020456
128: 0.053103
129: 0.045893
130: 0.032673
131: -0.004911
132: 0.007626
133: -0.065457
134: -0.045406
135: 0.245762
136: -0.438799
137: 0.000000
138: 0.000000
139: 0.000000
140: 0.000000
141: 0.000000
142: 1.189222
143: 0.000000
144: 1.093981
145: -0.938003
146: 0.090064
147: -0.202659
148: 0.411374
149: -0.507071
150: 0.021472
151: 0.063164
152: 0.126469
153: 0.115376
154: 0.151555
155: 0.219725
156: 0.129269
157: 0.207881
158: 0.076247
159: 0.086470
160: 0.100062
161: 0.141866
162: 0.178016
163: 0.006952
164: 0.062815
165: 1.786331
166: -0.822882
167: 0.000000
168: 0.000000
169: 0.000000
170: -0.499954
171: 0.326779
172: -0.031915
173: -0.093464
174: 0.000736
175: 0.129968
176: -0.083525
177: -0.195940
178: -0.045321
179: 0.006471
180: -0.121955
181: -0.036847
182: -0.025118
183: -0.027645
184: -0.040721
185: -0.096115
186: 0.023831
187: -0.020653
188: 0.010907
189: -0.138990
190: -0.146661
191: 0.227304
192: 0.224015
193: -4.896863
194: 0.000000
195: 0.000000
196: -1.529101
197: -0.154254
198: 0.312838
199: -0.184444
200: -0.059179
201: -0.027950
202: -0.109623
203: 0.003589
204: 0.019878
205: -0.001513
206: -0.008211
207: -0.060887
208: -0.016978
209: -0.020237
210: -0.028303
211: -0.052795
212: 0.000485
213: -0.055951
214: -0.019855
215: 0.061437
216: -0.021363
217: 0.116053
218: 0.082764
219: -0.065981
220: -0.213218
221: -0.095757
222: 0.142965
223: 0.000000
224: 0.126168
225: -0.285753
226: -0.122659
227: 0.010747
228: -0.067309
229: 0.186079
230: -0.002979
231: -0.083971
232: 0.016701
233: 0.043679
234: -0.040777
235: -0.119654
236: -0.064479
237: -0.017134
238: -0.019433
239: -0.053136
240: -0.030955
241: 0.007546
242: 0.053089
243: 0.006358
244: 0.015594
245: -0.031844
246: -0.051981
247: 0.039805
248: -0.040508
249: 0.667843
250: 0.000000
251: 0.000000
252: 4.465733
253: 0.205990
254: 0.023950
255: -0.062759
256: -0.025191
257: 0.004727
258: -0.019160
259: 0.074315
260: -0.130102
261: -0.002475
262: -0.050499
263: -0.092816
264: 0.008192
265: 0.045368
266: -0.012614
267: -0.059841
268: -0.011803
269: -0.008385
270: 0.001182
271: 0.001842
272: 0.004107
273: -0.036257
274: 0.027511
275: -0.085096
276: -0.004634
277: -0.399918
278: -1.779999
279: -0.113281
280: -248.839479
281: -0.273016
282: -0.084492
283: 0.094041
284: -0.007951
285: 0.004452
286: -0.046347
287: -0.036485
288: -0.002184
289: 0.012407
290: -0.073817
291: 0.030072
292: 0.052285
293: -0.064317
294: -0.091785
295: -0.035475
296: -0.036686
297: -0.049523
298: -0.044281
299: -0.063768
300: 0.021065
301: 0.017996
302: 0.055413
303: 0.171224
304: -0.182209
305: 0.045277
306: 0.597107
307: -0.808531
308: 0.667049
309: -0.002651
310: 0.178182
311: 0.008410
312: -0.119645
313: 0.007647
314: -0.025730
315: -0.046087
316: 0.029939
317: -0.024486
318: -0.019424
319: 0.010958
320: 0.002173
321: -0.139689
322: -0.032178
323: 0.074776
324: -0.059912
325: -0.068954
326: -0.051707
327: -0.040667
328: 0.014062
329: 0.003266
330: 0.016129
331: 0.125939
332: -0.185239
333: 0.533909
334: 17.812770
335: 0.000000
336: 0.000000
337: 0.099877
338: -0.137718
339: -0.119351
340: 0.072362
341: -0.030359
342: 0.066968
343: 0.014713
344: -0.077926
345: 0.030972
346: 0.049349
347: -0.104626
348: -0.062493
349: 0.030078
350: 0.317627
351: 0.040831
352: -0.053667
353: -0.047309
354: -0.015200
355: -0.038937
356: -0.038340
357: 0.009100
358: -0.181476
359: -0.034584
360: 0.706422
361: -0.695116
362: 0.000000
363: 0.000000
364: 0.000000
365: -1.052986
366: 0.021074
367: 0.032655
368: -0.274978
369: 0.009517
370: -0.079271
371: 0.081488
372: -0.062065
373: -0.111165
374: -0.013024
375: -0.054088
376: 0.232984
377: 0.105593
378: 0.401891
379: -0.087088
380: 0.056730
381: -0.035660
382: 0.016467
383: 0.014458
384: -0.036232
385: -0.078028
386: -0.103781
387: 0.134876
388: -0.907634
389: 0.192573
390: -13.914623
391: 0.000000
392: 0.000000
393: -8.032924
394: 0.578574
395: 0.072917
396: -0.020414
397: -0.010964
398: -0.083583
399: -0.035787
400: -0.046153
401: 0.139062
402: -0.032610
403: 0.093645
404: -0.078055
405: 0.093204
406: 0.143825
407: -0.002579
408: -0.019800
409: -0.065768
410: -0.012284
411: 0.003540
412: -0.036298
413: 0.045493
414: 0.017233
415: -0.262551
416: -0.458219
417: 0.927049
418: 0.410847
419: 0.000000
420: -8.685817
421: 0.000000
422: 0.000000
423: 0.243208
424: 0.178327
425: 0.024150
426: 0.169748
427: -0.057198
428: 0.108685
429: -0.129777
430: -0.077024
431: -0.106309
432: 0.000649
433: 0.081084
434: 0.034155
435: 0.013487
436: -0.053292
437: -0.045110
438: -0.016241
439: 0.005684
440: 0.125929
441: -0.166887
442: -0.039889
443: -0.120305
444: 0.375053
445: -0.453969
446: 1.655480
447: 0.000000
448: 0.302300
449: -4.435985
450: -25.332182
451: -0.842183
452: -0.581136
453: 0.055001
454: -0.184132
455: 0.018367
456: -0.025428
457: 0.001729
458: 0.002517
459: -0.051129
460: -0.029314
461: -0.000440
462: 0.060139
463: -0.000435
464: -0.052892
465: -0.000255
466: -0.052628
467: -0.069256
468: -0.088731
469: 0.060763
470: 0.006446
471: 0.074751
472: 0.052634
473: 0.250613
474: 0.000000
475: 0.000000
476: 0.000000
477: 0.811022
478: -3.508993
479: 2.424739
480: -0.421863
481: 0.430718
482: -0.149879
483: 0.083414
484: 0.066961
485: 0.074208
486: -0.044743
487: -0.054290
488: 0.004557
489: -0.015733
490: 0.058904
491: -0.012205
492: 0.005583
493: 0.029152
494: -0.009343
495: 0.059740
496: -0.148277
497: 0.188470
498: -0.091244
499: -0.085046
500: -0.319787
501: -1.234571
502: -1.858744
503: 5.688208
504: 0.000000
505: 14.495603
506: 0.029609
507: -0.272286
508: -0.400680
509: -0.233000
510: 0.102372
511: 0.029991
512: -0.039485
513: -0.020060
514: -0.008819
515: 0.012361
516: 0.016709
517: -0.025753
518: 0.001287
519: 0.020156
520: 0.037843
521: 0.066784
522: -0.037968
523: -0.148600
524: 0.130455
525: -0.256891
526: 0.362308
527: 0.095027
528: 0.445491
529: 2.191192
530: -0.340096
531: 0.706388
532: 0.000000
533: -0.380956
534: 1.204313
535: 0.105744
536: -0.508197
537: 0.600230
538: -0.330184
539: 0.061248
540: -0.064969
541: 0.018006
542: -0.008948
543: 0.080493
544: -0.041904
545: 0.027249
546: -0.020755
547: 0.047566
548: 0.075046
549: 0.017483
550: 0.129459
551: -0.005925
552: 0.165702
553: -0.232492
554: -0.508934
555: 0.029519
556: -1.111918
557: 0.718296
558: 0.000000
559: -0.304070
560: 0.000000
561: -2.462945
562: -10.411344
563: -0.134921
564: 0.586500
565: -0.455416
566: -0.179787
567: -0.132657
568: -0.012116
569: 0.055675
570: 0.013127
571: 0.011632
572: -0.022642
573: -0.026084
574: -0.000615
575: -0.002987
576: 0.025979
577: 0.063206
578: 0.136171
579: -0.046480
580: -0.210957
581: 0.150137
582: 0.271614
583: 0.968553
584: -0.252393
585: -0.243466
586: 0.000000
587: 0.000000
588: -1.113552
589: 0.000000
590: 0.000000
591: 2.261483
592: -0.052684
593: 0.374361
594: 0.176239
595: 0.326205
596: 0.072901
597: -0.004603
598: -0.022993
599: 0.003594
600: -0.018626
601: 0.001573
602: -0.011066
603: 0.007779
604: -0.007261
605: -0.069711
606: -0.065467
607: 0.234823
608: 0.030825
609: 0.227108
610: -0.021678
611: 0.562302
612: -0.696347
613: 1.115765
614: 0.210318
615: 0.000000
616: 0.162797
617: 0.000000
618: 0.000000
619: -2.155993
620: 0.322670
621: -0.166706
622: 0.125919
623: -0.052014
624: 0.047803
625: 0.042168
626: -0.001109
627: 0.005207
628: -0.016561
629: 0.063505
630: -0.040736
631: 0.008214
632: -0.044166
633: -0.044067
634: 0.033685
635: -0.142947
636: 0.086042
637: -0.012293
638: -0.496915
639: 0.827429
640: 0.682105
641: -1.758731
642: 0.000000
643: 0.000000
644: 0.000000
645: 0.000000
646: 0.000000
647: 1.272419
648: -0.512667
649: 0.199520
650: -0.195903
651: -0.010081
652: -0.123173
653: 0.035067
654: 0.009721
655: 0.003292
656: -0.001983
657: 0.002835
658: -0.024618
659: -0.026290
660: -0.011121
661: 0.071700
662: -0.037119
663: -0.040544
664: 0.132051
665: 0.052738
666: 0.158742
667: -0.724996
668: 0.515968
669: 0.000000
670: 0.000000
671: 0.000000
672: 0.000000
673: 0.000000
674: -0.343633
675: -0.170409
676: -0.334390
677: -0.047393
678: -0.025653
679: -0.049076
680: 0.057906
681: 0.006372
682: 0.044818
683: 0.042977
684: 0.066207
685: 0.029532
686: 0.023451
687: 0.082099
688: 0.013682
689: 0.091892
690: 0.170753
691: 0.136179
692: -0.397666
693: 0.060628
694: 0.731323
695: 2.146371
696: -0.724315
697: -0.683131
698: 0.000000
699: 0.000000
700: 0.000000
701: 0.000000
702: 0.000000
703: 0.753028
704: -0.508102
705: 0.246303
706: 0.077869
707: -0.150077
708: 0.085474
709: -0.043162
710: -0.027328
711: -0.043222
712: 0.004206
713: 0.004106
714: 0.047066
715: -0.060931
716: -0.044357
717: -0.107667
718: -0.258108
719: -0.001071
720: 0.239737
721: 0.274898
722: -0.994054
723: 4.797108
724: 0.126343
725: 0.000000
726: 0.000000
727: 0.000000
728: 0.000000
729: 0.000000
730: 0.000000
731: 0.000000
732: 0.325264
733: -0.403374
734: 0.028788
735: 0.096907
736: -0.105736
737: -0.006565
738: -0.009703
739: 0.012954
740: -0.016659
741: -0.065025
742: -0.024660
743: 0.042890
744: 0.012772
745: 0.077616
746: 0.155224
747: 0.110093
748: -0.075148
749: 0.085505
750: 0.346499
751: -1.504359
752: 0.000000
753: 0.000000
754: 0.000000
755: 0.000000
756: 0.000000
757: 0.000000
758: 0.000000
759: 0.000000
760: 0.079685
761: -0.535093
762: 0.573362
763: -0.562727
764: 0.543879
765: -0.029345
766: 0.015804
767: -0.029969
768: 0.001986
769: -0.115815
770: 0.007334
771: -0.108838
772: 0.010197
773: -0.094559
774: -0.019316
775: -0.092565
776: -0.447288
777: 0.209396
778: -1.279342
779: -0.143597
780: 0.000000
781: 0.000000
782: 0.000000
783: 0.000000
